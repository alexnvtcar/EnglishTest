<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>–ö–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</title>
    
    <!-- PWA –º–µ—Ç–∞-—Ç–µ–≥–∏ -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="English Learning Test">
    <meta name="format-detection" content="telephone=no">
    <meta name="msapplication-tap-highlight" content="no">
    
    <!-- –°—Ç–∏–ª–∏ -->
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="animations-fix.css">
    <link rel="stylesheet" href="z-index-fix.css">
    
    <style>
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f8fafc;
            min-height: 100vh;
        }
        
        .test-header {
            background: linear-gradient(135deg, #1e40af, #3b82f6);
            color: white;
            padding: 30px;
            border-radius: 16px;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .test-section {
            background: white;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .test-card {
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .test-card:hover {
            border-color: #3b82f6;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px -5px rgba(59, 130, 246, 0.2);
        }
        
        .test-card.success {
            border-color: #10b981;
            background: #f0fdf4;
        }
        
        .test-card.error {
            border-color: #ef4444;
            background: #fef2f2;
        }
        
        .test-card.warning {
            border-color: #f59e0b;
            background: #fffbeb;
        }
        
        .test-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }
        
        .test-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 10px;
            color: #1f2937;
        }
        
        .test-description {
            font-size: 0.9rem;
            color: #6b7280;
            margin-bottom: 15px;
        }
        
        .test-button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s ease;
        }
        
        .test-button:hover {
            background: #2563eb;
            transform: translateY(-1px);
        }
        
        .test-button:disabled {
            background: #9ca3af;
            cursor: not-allowed;
        }
        
        .device-info {
            background: #f0f9ff;
            border: 1px solid #bae6fd;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
        }
        
        .device-info h3 {
            color: #0369a1;
            margin-bottom: 10px;
        }
        
        .device-info p {
            margin: 5px 0;
            font-size: 0.9rem;
        }
        
        .test-results {
            background: #f9fafb;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .test-results h4 {
            color: #374151;
            margin-bottom: 10px;
        }
        
        .test-log {
            font-family: monospace;
            font-size: 0.8rem;
            line-height: 1.4;
        }
        
        .test-log .success { color: #059669; }
        .test-log .error { color: #dc2626; }
        .test-log .warning { color: #d97706; }
        .test-log .info { color: #2563eb; }
        
        @media (max-width: 768px) {
            .test-container {
                padding: 10px;
            }
            
            .test-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .test-card {
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="test-header">
            <h1>üß™ –ö–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</h1>
            <p>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π –Ω–∞ –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö</p>
        </div>
        
        <div class="device-info">
            <h3>üì± –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ</h3>
            <div id="deviceInfo"></div>
        </div>
        
        <div class="test-section">
            <h2>üîß –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ—Å—Ç—ã</h2>
            <div class="test-grid">
                <div class="test-card" id="pwaTest">
                    <div class="test-icon">üì±</div>
                    <div class="test-title">PWA –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å</div>
                    <div class="test-description">–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏ —Ä–∞–±–æ—Ç—ã PWA</div>
                    <button class="test-button" onclick="testPWA()">–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç</button>
                </div>
                
                <div class="test-card" id="uiTest">
                    <div class="test-icon">üé®</div>
                    <div class="test-title">–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π UI</div>
                    <div class="test-description">–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–∑—ã–≤—á–∏–≤–æ—Å—Ç–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞</div>
                    <button class="test-button" onclick="testUI()">–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç</button>
                </div>
                
                <div class="test-card" id="touchTest">
                    <div class="test-icon">üëÜ</div>
                    <div class="test-title">Touch –°–æ–±—ã—Ç–∏—è</div>
                    <div class="test-description">–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—Å–∞–Ω–∏–π –∏ –∂–µ—Å—Ç–æ–≤</div>
                    <button class="test-button" onclick="testTouch()">–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç</button>
                </div>
                
                <div class="test-card" id="modalTest">
                    <div class="test-icon">ü™ü</div>
                    <div class="test-title">–ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞</div>
                    <div class="test-description">–ü—Ä–æ–≤–µ—Ä–∫–∞ z-index –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è</div>
                    <button class="test-button" onclick="testModals()">–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç</button>
                </div>
                
                <div class="test-card" id="animationTest">
                    <div class="test-icon">‚ú®</div>
                    <div class="test-title">–ê–Ω–∏–º–∞—Ü–∏–∏</div>
                    <div class="test-description">–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</div>
                    <button class="test-button" onclick="testAnimations()">–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç</button>
                </div>
                
                <div class="test-card" id="firebaseTest">
                    <div class="test-icon">üî•</div>
                    <div class="test-title">Firebase</div>
                    <div class="test-description">–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏</div>
                    <button class="test-button" onclick="testFirebase()">–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç</button>
                </div>
                
                <div class="test-card" id="offlineTest">
                    <div class="test-icon">üì¥</div>
                    <div class="test-title">–û—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º</div>
                    <div class="test-description">–†–∞–±–æ—Ç–∞ –±–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞</div>
                    <button class="test-button" onclick="testOffline()">–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç</button>
                </div>
                
                <div class="test-card" id="dataTest">
                    <div class="test-icon">üíæ</div>
                    <div class="test-title">–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</div>
                    <div class="test-description">localStorage –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è</div>
                    <button class="test-button" onclick="testDataPersistence()">–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç</button>
                </div>
            </div>
        </div>
        
        <div class="test-section">
            <h2>üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</h2>
            <div class="test-results">
                <h4>–õ–æ–≥ —Ç–µ—Å—Ç–æ–≤:</h4>
                <div class="test-log" id="testLog"></div>
            </div>
            <button class="test-button" onclick="clearLog()" style="margin-top: 10px;">–û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥</button>
        </div>
        
        <div class="test-section">
            <h2>üöÄ –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h2>
            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                <button class="test-button" onclick="runAllTests()">–ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã</button>
                <button class="test-button" onclick="openMainApp()">–û—Ç–∫—Ä—ã—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</button>
                <button class="test-button" onclick="exportTestResults()">–≠–∫—Å–ø–æ—Ä—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</button>
            </div>
        </div>
    </div>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        let testResults = {};
        let currentTest = null;
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            updateDeviceInfo();
            log('üöÄ –ö–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ', 'info');
        });
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
        function updateDeviceInfo() {
            const deviceInfo = document.getElementById('deviceInfo');
            const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
            const isAndroid = /Android/.test(navigator.userAgent);
            const isMobile = /Mobi|Android/i.test(navigator.userAgent);
            const isTablet = /iPad|Android/i.test(navigator.userAgent) && !/Mobile/i.test(navigator.userAgent);
            
            deviceInfo.innerHTML = `
                <p><strong>User Agent:</strong> ${navigator.userAgent}</p>
                <p><strong>–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞:</strong> ${navigator.platform}</p>
                <p><strong>–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ:</strong> ${screen.width}x${screen.height}</p>
                <p><strong>Viewport:</strong> ${window.innerWidth}x${window.innerHeight}</p>
                <p><strong>–¢–∏–ø —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞:</strong> ${isTablet ? '–ü–ª–∞–Ω—à–µ—Ç' : isMobile ? '–ú–æ–±–∏–ª—å–Ω–æ–µ' : '–î–µ—Å–∫—Ç–æ–ø'}</p>
                <p><strong>–û–°:</strong> ${isIOS ? 'iOS' : isAndroid ? 'Android' : '–î—Ä—É–≥–æ–µ'}</p>
                <p><strong>Touch –ø–æ–¥–¥–µ—Ä–∂–∫–∞:</strong> ${('ontouchstart' in window) ? '–î–∞' : '–ù–µ—Ç'}</p>
                <p><strong>Service Worker:</strong> ${('serviceWorker' in navigator) ? '–î–∞' : '–ù–µ—Ç'}</p>
                <p><strong>localStorage:</strong> ${typeof(Storage) !== "undefined" ? '–î–∞' : '–ù–µ—Ç'}</p>
                <p><strong>–û–Ω–ª–∞–π–Ω:</strong> ${navigator.onLine ? '–î–∞' : '–ù–µ—Ç'}</p>
            `;
        }
        
        // –°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
        function log(message, type = 'info') {
            const testLog = document.getElementById('testLog');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.className = type;
            logEntry.textContent = `[${timestamp}] ${message}`;
            testLog.appendChild(logEntry);
            testLog.scrollTop = testLog.scrollHeight;
            console.log(`[${type.toUpperCase()}] ${message}`);
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ —Ç–µ—Å—Ç–∞
        function updateTestStatus(testId, status, message = '') {
            const testCard = document.getElementById(testId);
            testCard.className = `test-card ${status}`;
            
            if (message) {
                const description = testCard.querySelector('.test-description');
                description.textContent = message;
            }
            
            testResults[testId] = { status, message, timestamp: new Date() };
        }
        
        // –¢–µ—Å—Ç PWA —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
        async function testPWA() {
            log('üì± –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∞ PWA —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏...', 'info');
            updateTestStatus('pwaTest', 'warning', '–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ...');
            
            try {
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞
                const manifestResponse = await fetch('./manifest.json');
                if (!manifestResponse.ok) throw new Error('Manifest –Ω–µ –Ω–∞–π–¥–µ–Ω');
                const manifest = await manifestResponse.json();
                log('‚úÖ Manifest –∑–∞–≥—Ä—É–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ', 'success');
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ Service Worker
                if ('serviceWorker' in navigator) {
                    const registration = await navigator.serviceWorker.register('./sw.js');
                    log('‚úÖ Service Worker –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω', 'success');
                } else {
                    throw new Error('Service Worker –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è');
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ PWA
                const isInstalled = window.matchMedia('(display-mode: standalone)').matches;
                log(`PWA —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: ${isInstalled ? '–î–∞' : '–ù–µ—Ç'}`, isInstalled ? 'success' : 'warning');
                
                updateTestStatus('pwaTest', 'success', 'PWA —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ');
                log('‚úÖ –¢–µ—Å—Ç PWA –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ', 'success');
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ PWA —Ç–µ—Å—Ç–∞: ${error.message}`, 'error');
                updateTestStatus('pwaTest', 'error', `–û—à–∏–±–∫–∞: ${error.message}`);
            }
        }
        
        // –¢–µ—Å—Ç –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ UI
        function testUI() {
            log('üé® –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∞ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ UI...', 'info');
            updateTestStatus('uiTest', 'warning', '–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ...');
            
            try {
                const viewportWidth = window.innerWidth;
                const viewportHeight = window.innerHeight;
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ–¥–∏–∞-–∑–∞–ø—Ä–æ—Å–æ–≤
                const isMobile = viewportWidth <= 768;
                const isTablet = viewportWidth > 768 && viewportWidth <= 1024;
                const isDesktop = viewportWidth > 1024;
                
                log(`–†–∞–∑–º–µ—Ä —ç–∫—Ä–∞–Ω–∞: ${viewportWidth}x${viewportHeight}`, 'info');
                log(`–¢–∏–ø —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞: ${isMobile ? '–ú–æ–±–∏–ª—å–Ω–æ–µ' : isTablet ? '–ü–ª–∞–Ω—à–µ—Ç' : '–î–µ—Å–∫—Ç–æ–ø'}`, 'info');
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
                const container = document.querySelector('.test-container');
                if (container) {
                    const containerWidth = container.offsetWidth;
                    log(`–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä: ${containerWidth}px`, 'info');
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ç–∫–∏
                const grid = document.querySelector('.test-grid');
                if (grid) {
                    const gridStyle = window.getComputedStyle(grid);
                    const gridColumns = gridStyle.gridTemplateColumns;
                    log(`–°–µ—Ç–∫–∞: ${gridColumns}`, 'info');
                }
                
                updateTestStatus('uiTest', 'success', 'UI –∞–¥–∞–ø—Ç–∏–≤–µ–Ω');
                log('‚úÖ –¢–µ—Å—Ç UI –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ', 'success');
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ UI —Ç–µ—Å—Ç–∞: ${error.message}`, 'error');
                updateTestStatus('uiTest', 'error', `–û—à–∏–±–∫–∞: ${error.message}`);
            }
        }
        
        // –¢–µ—Å—Ç touch —Å–æ–±—ã—Ç–∏–π
        function testTouch() {
            log('üëÜ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∞ touch —Å–æ–±—ã—Ç–∏–π...', 'info');
            updateTestStatus('touchTest', 'warning', '–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ...');
            
            try {
                const touchSupported = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
                log(`Touch –ø–æ–¥–¥–µ—Ä–∂–∫–∞: ${touchSupported ? '–î–∞' : '–ù–µ—Ç'}`, touchSupported ? 'success' : 'warning');
                
                if (touchSupported) {
                    // –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç
                    const testElement = document.createElement('div');
                    testElement.style.cssText = `
                        position: fixed;
                        top: 50%;
                        left: 50%;
                        transform: translate(-50%, -50%);
                        width: 100px;
                        height: 100px;
                        background: #3b82f6;
                        border-radius: 50%;
                        z-index: 10000;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        color: white;
                        font-weight: bold;
                        cursor: pointer;
                    `;
                    testElement.textContent = '–ö–æ—Å–Ω–∏—Å—å';
                    
                    let touchEvents = [];
                    
                    testElement.addEventListener('touchstart', (e) => {
                        touchEvents.push('touchstart');
                        log('üëÜ touchstart —Å–æ–±—ã—Ç–∏–µ', 'success');
                        testElement.style.background = '#10b981';
                    });
                    
                    testElement.addEventListener('touchend', (e) => {
                        touchEvents.push('touchend');
                        log('üëÜ touchend —Å–æ–±—ã—Ç–∏–µ', 'success');
                        testElement.style.background = '#3b82f6';
                    });
                    
                    testElement.addEventListener('touchmove', (e) => {
                        touchEvents.push('touchmove');
                        log('üëÜ touchmove —Å–æ–±—ã—Ç–∏–µ', 'success');
                    });
                    
                    document.body.appendChild(testElement);
                    
                    // –£–¥–∞–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
                    setTimeout(() => {
                        document.body.removeChild(testElement);
                        log(`Touch —Å–æ–±—ã—Ç–∏—è –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã: ${touchEvents.join(', ')}`, 'info');
                        updateTestStatus('touchTest', 'success', 'Touch —Ä–∞–±–æ—Ç–∞–µ—Ç');
                        log('‚úÖ –¢–µ—Å—Ç touch –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ', 'success');
                    }, 5000);
                } else {
                    updateTestStatus('touchTest', 'warning', 'Touch –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è');
                    log('‚ö†Ô∏è Touch —Å–æ–±—ã—Ç–∏—è –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –Ω–∞ —ç—Ç–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ', 'warning');
                }
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ touch —Ç–µ—Å—Ç–∞: ${error.message}`, 'error');
                updateTestStatus('touchTest', 'error', `–û—à–∏–±–∫–∞: ${error.message}`);
            }
        }
        
        // –¢–µ—Å—Ç –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
        function testModals() {
            log('ü™ü –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∞ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω...', 'info');
            updateTestStatus('modalTest', 'warning', '–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ...');
            
            try {
                // –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
                const modal = document.createElement('div');
                modal.className = 'modal';
                modal.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0, 0, 0, 0.5);
                    z-index: 10000;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                `;
                
                const modalContent = document.createElement('div');
                modalContent.style.cssText = `
                    background: white;
                    padding: 30px;
                    border-radius: 12px;
                    max-width: 400px;
                    width: 90%;
                    text-align: center;
                `;
                
                modalContent.innerHTML = `
                    <h3>–¢–µ—Å—Ç–æ–≤–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ</h3>
                    <p>–ü—Ä–æ–≤–µ—Ä–∫–∞ z-index –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è</p>
                    <button onclick="this.closest('.modal').remove()" style="
                        background: #3b82f6;
                        color: white;
                        border: none;
                        padding: 10px 20px;
                        border-radius: 6px;
                        cursor: pointer;
                        margin-top: 15px;
                    ">–ó–∞–∫—Ä—ã—Ç—å</button>
                `;
                
                modal.appendChild(modalContent);
                document.body.appendChild(modal);
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º z-index
                const computedStyle = window.getComputedStyle(modal);
                const zIndex = computedStyle.zIndex;
                log(`Z-index –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞: ${zIndex}`, 'info');
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
                const rect = modal.getBoundingClientRect();
                log(`–ü–æ–∑–∏—Ü–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞: ${rect.top}, ${rect.left}`, 'info');
                
                updateTestStatus('modalTest', 'success', '–ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ —Ä–∞–±–æ—Ç–∞—é—Ç');
                log('‚úÖ –¢–µ—Å—Ç –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ', 'success');
                
                // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–∫—Ä—ã–≤–∞–µ–º —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
                setTimeout(() => {
                    if (document.body.contains(modal)) {
                        document.body.removeChild(modal);
                    }
                }, 3000);
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞: ${error.message}`, 'error');
                updateTestStatus('modalTest', 'error', `–û—à–∏–±–∫–∞: ${error.message}`);
            }
        }
        
        // –¢–µ—Å—Ç –∞–Ω–∏–º–∞—Ü–∏–π
        function testAnimations() {
            log('‚ú® –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∞ –∞–Ω–∏–º–∞—Ü–∏–π...', 'info');
            updateTestStatus('animationTest', 'warning', '–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ...');
            
            try {
                // –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π
                const testElement = document.createElement('div');
                testElement.style.cssText = `
                    position: fixed;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    width: 100px;
                    height: 100px;
                    background: linear-gradient(45deg, #3b82f6, #8b5cf6);
                    border-radius: 50%;
                    z-index: 10000;
                    animation: testAnimation 2s ease-in-out infinite;
                `;
                
                // –î–æ–±–∞–≤–ª—è–µ–º CSS –∞–Ω–∏–º–∞—Ü–∏—é
                const style = document.createElement('style');
                style.textContent = `
                    @keyframes testAnimation {
                        0% { transform: translate(-50%, -50%) scale(1) rotate(0deg); }
                        50% { transform: translate(-50%, -50%) scale(1.2) rotate(180deg); }
                        100% { transform: translate(-50%, -50%) scale(1) rotate(360deg); }
                    }
                `;
                document.head.appendChild(style);
                
                document.body.appendChild(testElement);
                
                // –ò–∑–º–µ—Ä—è–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
                let frameCount = 0;
                const startTime = performance.now();
                
                const countFrames = () => {
                    frameCount++;
                    if (performance.now() - startTime < 2000) {
                        requestAnimationFrame(countFrames);
                    } else {
                        const fps = Math.round(frameCount / 2);
                        log(`FPS –∞–Ω–∏–º–∞—Ü–∏–∏: ${fps}`, fps > 30 ? 'success' : 'warning');
                        
                        // –û—á–∏—â–∞–µ–º
                        document.body.removeChild(testElement);
                        document.head.removeChild(style);
                        
                        updateTestStatus('animationTest', fps > 30 ? 'success' : 'warning', 
                            fps > 30 ? '–ê–Ω–∏–º–∞—Ü–∏–∏ –ø–ª–∞–≤–Ω—ã–µ' : '–ù–∏–∑–∫–∏–π FPS');
                        log('‚úÖ –¢–µ—Å—Ç –∞–Ω–∏–º–∞—Ü–∏–π –∑–∞–≤–µ—Ä—à–µ–Ω', 'success');
                    }
                };
                
                requestAnimationFrame(countFrames);
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –∞–Ω–∏–º–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞: ${error.message}`, 'error');
                updateTestStatus('animationTest', 'error', `–û—à–∏–±–∫–∞: ${error.message}`);
            }
        }
        
        // –¢–µ—Å—Ç Firebase
        async function testFirebase() {
            log('üî• –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∞ Firebase...', 'info');
            updateTestStatus('firebaseTest', 'warning', '–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ...');
            
            try {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å Firebase
                if (typeof window.db === 'undefined') {
                    throw new Error('Firebase –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
                }
                
                log('‚úÖ Firebase –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω', 'success');
                
                // –¢–µ—Å—Ç–∏—Ä—É–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
                const testData = {
                    test: true,
                    timestamp: new Date().toISOString(),
                    device: navigator.userAgent
                };
                
                // –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–ø–∏—Å–∏ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
                try {
                    const testDoc = window.doc(window.collection(window.db, 'test'), 'connection-test');
                    await window.setDoc(testDoc, testData);
                    log('‚úÖ –ó–∞–ø–∏—Å—å –≤ Firebase —É—Å–ø–µ—à–Ω–∞', 'success');
                    
                    // –ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
                    const docSnap = await window.getDoc(testDoc);
                    if (docSnap.exists()) {
                        log('‚úÖ –ß—Ç–µ–Ω–∏–µ –∏–∑ Firebase —É—Å–ø–µ—à–Ω–æ', 'success');
                        updateTestStatus('firebaseTest', 'success', 'Firebase —Ä–∞–±–æ—Ç–∞–µ—Ç');
                    } else {
                        throw new Error('–î–∞–Ω–Ω—ã–µ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã');
                    }
                } catch (firebaseError) {
                    log(`‚ö†Ô∏è Firebase –æ—à–∏–±–∫–∞: ${firebaseError.message}`, 'warning');
                    updateTestStatus('firebaseTest', 'warning', 'Firebase –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω');
                }
                
                log('‚úÖ –¢–µ—Å—Ç Firebase –∑–∞–≤–µ—Ä—à–µ–Ω', 'success');
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ Firebase —Ç–µ—Å—Ç–∞: ${error.message}`, 'error');
                updateTestStatus('firebaseTest', 'error', `–û—à–∏–±–∫–∞: ${error.message}`);
            }
        }
        
        // –¢–µ—Å—Ç –æ—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º–∞
        function testOffline() {
            log('üì¥ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∞ –æ—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º–∞...', 'info');
            updateTestStatus('offlineTest', 'warning', '–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ...');
            
            try {
                const isOnline = navigator.onLine;
                log(`–°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: ${isOnline ? '–û–Ω–ª–∞–π–Ω' : '–û—Ñ–ª–∞–π–Ω'}`, isOnline ? 'success' : 'warning');
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º Service Worker –¥–ª—è –æ—Ñ–ª–∞–π–Ω —Ä–∞–±–æ—Ç—ã
                if ('serviceWorker' in navigator) {
                    navigator.serviceWorker.ready.then(registration => {
                        log('‚úÖ Service Worker –≥–æ—Ç–æ–≤ –¥–ª—è –æ—Ñ–ª–∞–π–Ω —Ä–∞–±–æ—Ç—ã', 'success');
                        updateTestStatus('offlineTest', 'success', '–û—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è');
                    }).catch(error => {
                        log(`‚ö†Ô∏è Service Worker –Ω–µ –≥–æ—Ç–æ–≤: ${error.message}`, 'warning');
                        updateTestStatus('offlineTest', 'warning', '–û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –æ—Ñ–ª–∞–π–Ω –ø–æ–¥–¥–µ—Ä–∂–∫–∞');
                    });
                } else {
                    log('‚ùå Service Worker –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è', 'error');
                    updateTestStatus('offlineTest', 'error', '–û—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è');
                }
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º localStorage –¥–ª—è –æ—Ñ–ª–∞–π–Ω –¥–∞–Ω–Ω—ã—Ö
                try {
                    localStorage.setItem('offline-test', 'test-value');
                    const testValue = localStorage.getItem('offline-test');
                    if (testValue === 'test-value') {
                        log('‚úÖ localStorage —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –æ—Ñ–ª–∞–π–Ω –¥–∞–Ω–Ω—ã—Ö', 'success');
                        localStorage.removeItem('offline-test');
                    } else {
                        throw new Error('localStorage –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç');
                    }
                } catch (storageError) {
                    log(`‚ùå localStorage –æ—à–∏–±–∫–∞: ${storageError.message}`, 'error');
                    updateTestStatus('offlineTest', 'error', '–ù–µ—Ç –æ—Ñ–ª–∞–π–Ω —Ö—Ä–∞–Ω–µ–Ω–∏—è');
                }
                
                log('‚úÖ –¢–µ—Å—Ç –æ—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º–∞ –∑–∞–≤–µ—Ä—à–µ–Ω', 'success');
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –æ—Ñ–ª–∞–π–Ω —Ç–µ—Å—Ç–∞: ${error.message}`, 'error');
                updateTestStatus('offlineTest', 'error', `–û—à–∏–±–∫–∞: ${error.message}`);
            }
        }
        
        // –¢–µ—Å—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
        function testDataPersistence() {
            log('üíæ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö...', 'info');
            updateTestStatus('dataTest', 'warning', '–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ...');
            
            try {
                // –¢–µ—Å—Ç localStorage
                const testData = {
                    timestamp: new Date().toISOString(),
                    test: true,
                    device: navigator.userAgent,
                    random: Math.random()
                };
                
                try {
                    localStorage.setItem('test-persistence', JSON.stringify(testData));
                    const retrievedData = JSON.parse(localStorage.getItem('test-persistence'));
                    
                    if (retrievedData && retrievedData.test === testData.test) {
                        log('‚úÖ localStorage —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ', 'success');
                    } else {
                        throw new Error('–î–∞–Ω–Ω—ã–µ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç');
                    }
                    
                    localStorage.removeItem('test-persistence');
                } catch (storageError) {
                    log(`‚ùå localStorage –æ—à–∏–±–∫–∞: ${storageError.message}`, 'error');
                    throw storageError;
                }
                
                // –¢–µ—Å—Ç JSON —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏
                try {
                    const complexData = {
                        tasks: [{ id: 1, name: 'Test' }],
                        progress: { level: 1, xp: 100 },
                        settings: { theme: 'light' }
                    };
                    
                    const serialized = JSON.stringify(complexData);
                    const deserialized = JSON.parse(serialized);
                    
                    if (deserialized.tasks.length === complexData.tasks.length) {
                        log('‚úÖ JSON —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç', 'success');
                    } else {
                        throw new Error('JSON —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç');
                    }
                } catch (jsonError) {
                    log(`‚ùå JSON –æ—à–∏–±–∫–∞: ${jsonError.message}`, 'error');
                    throw jsonError;
                }
                
                updateTestStatus('dataTest', 'success', '–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç');
                log('‚úÖ –¢–µ—Å—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ', 'success');
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∞ –¥–∞–Ω–Ω—ã—Ö: ${error.message}`, 'error');
                updateTestStatus('dataTest', 'error', `–û—à–∏–±–∫–∞: ${error.message}`);
            }
        }
        
        // –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
        async function runAllTests() {
            log('üöÄ –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤...', 'info');
            
            const tests = [
                { name: 'PWA', func: testPWA },
                { name: 'UI', func: testUI },
                { name: 'Touch', func: testTouch },
                { name: 'Modals', func: testModals },
                { name: 'Animations', func: testAnimations },
                { name: 'Firebase', func: testFirebase },
                { name: 'Offline', func: testOffline },
                { name: 'Data', func: testDataPersistence }
            ];
            
            for (const test of tests) {
                log(`üîÑ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∞: ${test.name}`, 'info');
                try {
                    await test.func();
                    await new Promise(resolve => setTimeout(resolve, 1000)); // –ü–∞—É–∑–∞ –º–µ–∂–¥—É —Ç–µ—Å—Ç–∞–º–∏
                } catch (error) {
                    log(`‚ùå –û—à–∏–±–∫–∞ –≤ —Ç–µ—Å—Ç–µ ${test.name}: ${error.message}`, 'error');
                }
            }
            
            log('üèÅ –í—Å–µ —Ç–µ—Å—Ç—ã –∑–∞–≤–µ—Ä—à–µ–Ω—ã', 'info');
            
            // –ü–æ–¥—Å—á–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
            const results = Object.values(testResults);
            const successCount = results.filter(r => r.status === 'success').length;
            const errorCount = results.filter(r => r.status === 'error').length;
            const warningCount = results.filter(r => r.status === 'warning').length;
            
            log(`üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã: ‚úÖ ${successCount} —É—Å–ø–µ—à–Ω–æ, ‚ö†Ô∏è ${warningCount} –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π, ‚ùå ${errorCount} –æ—à–∏–±–æ–∫`, 'info');
        }
        
        // –û—Ç–∫—Ä—ã—Ç–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        function openMainApp() {
            window.open('./index.html', '_blank');
        }
        
        // –≠–∫—Å–ø–æ—Ä—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        function exportTestResults() {
            const results = {
                timestamp: new Date().toISOString(),
                device: {
                    userAgent: navigator.userAgent,
                    platform: navigator.platform,
                    screen: `${screen.width}x${screen.height}`,
                    viewport: `${window.innerWidth}x${window.innerHeight}`,
                    online: navigator.onLine
                },
                tests: testResults
            };
            
            const blob = new Blob([JSON.stringify(results, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `test-results-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            log('üìÅ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã', 'success');
        }
        
        // –û—á–∏—Å—Ç–∫–∞ –ª–æ–≥–∞
        function clearLog() {
            document.getElementById('testLog').innerHTML = '';
            testResults = {};
            log('üßπ –õ–æ–≥ –æ—á–∏—â–µ–Ω', 'info');
        }
    </script>
</body>
</html>

