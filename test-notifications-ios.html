<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>–¢–µ—Å—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –¥–ª—è iOS</title>
    
    <!-- iOS PWA –º–µ—Ç–∞-—Ç–µ–≥–∏ -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Notification Test">
    <meta name="format-detection" content="telephone=no">
    <meta name="msapplication-tap-highlight" content="no">
    
    <!-- –°—Ç–∏–ª–∏ -->
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="animations-fix.css">
    <link rel="stylesheet" href="z-index-fix.css">
    
    <style>
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f8fafc;
            min-height: 100vh;
        }
        
        .test-header {
            background: linear-gradient(135deg, #1e40af, #3b82f6);
            color: white;
            padding: 30px;
            border-radius: 16px;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .test-section {
            background: white;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        
        .test-button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 8px;
            transition: all 0.2s ease;
        }
        
        .test-button:hover {
            background: #2563eb;
            transform: translateY(-1px);
        }
        
        .test-button:active {
            transform: translateY(0);
        }
        
        .device-info {
            background: #f0f9ff;
            border: 1px solid #bae6fd;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
        }
        
        .timing-info {
            background: #fef3c7;
            border: 1px solid #f59e0b;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
        }
        
        .timing-info h3 {
            color: #92400e;
            margin-bottom: 10px;
        }
        
        .timing-info p {
            margin: 5px 0;
            font-size: 14px;
        }
        
        .test-results {
            background: #f9fafb;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .test-log {
            font-family: monospace;
            font-size: 12px;
            line-height: 1.4;
        }
        
        .test-log .success { color: #059669; }
        .test-log .error { color: #dc2626; }
        .test-log .warning { color: #d97706; }
        .test-log .info { color: #2563eb; }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #10b981;
            color: white;
            padding: 16px 24px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            transform: translateX(100%);
            transition: transform 0.3s ease;
            max-width: 300px;
            word-wrap: break-word;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification.success {
            background: #10b981;
        }
        
        .notification.error {
            background: #ef4444;
        }
        
        .notification.warning {
            background: #f59e0b;
        }
        
        .notification.info {
            background: #3b82f6;
        }
        
        @media (max-width: 768px) {
            .test-container {
                padding: 10px;
            }
            
            .notification {
                right: 10px;
                left: 10px;
                max-width: none;
            }
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="test-header">
            <h1>üîî –¢–µ—Å—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –¥–ª—è iOS</h1>
            <p>–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –Ω–∞ iPhone –∏ iPad</p>
        </div>
        
        <div class="device-info">
            <h3>üì± –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ</h3>
            <div id="deviceInfo"></div>
        </div>
        
        <div class="timing-info">
            <h3>‚è±Ô∏è –í—Ä–µ–º—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</h3>
            <p><strong>iPhone/iPad:</strong> 1 —Å–µ–∫—É–Ω–¥–∞ –¥–ª—è "–ó–∞–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ" –∏ "–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã"</p>
            <p><strong>iPhone/iPad:</strong> 0.8 —Å–µ–∫—É–Ω–¥—ã –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</p>
            <p><strong>–î—Ä—É–≥–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞:</strong> 3 —Å–µ–∫—É–Ω–¥—ã (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –≤—Ä–µ–º—è)</p>
        </div>
        
        <div class="test-section">
            <h2>üß™ –¢–µ—Å—Ç–æ–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h2>
            <p>–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫–∏ –Ω–∏–∂–µ, —á—Ç–æ–±—ã –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ç–∏–ø—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:</p>
            
            <div style="display: flex; flex-wrap: wrap; gap: 10px;">
                <button class="test-button" onclick="testTaskCompletion()">
                    ‚úÖ –ó–∞–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ
                </button>
                
                <button class="test-button" onclick="testDataSaved()">
                    üíæ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã
                </button>
                
                <button class="test-button" onclick="testInstantNotification()">
                    ‚ö° –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                </button>
                
                <button class="test-button" onclick="testQuickNotification()">
                    üöÄ –ë—ã—Å—Ç—Ä–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                </button>
                
                <button class="test-button" onclick="testNormalNotification()">
                    üì¢ –û–±—ã—á–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                </button>
                
                <button class="test-button" onclick="testMultipleNotifications()">
                    üîÑ –ù–µ—Å–∫–æ–ª—å–∫–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
                </button>
            </div>
        </div>
        
        <div class="test-section">
            <h2>üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</h2>
            <div class="test-results">
                <h4>–õ–æ–≥ —Ç–µ—Å—Ç–æ–≤:</h4>
                <div class="test-log" id="testLog"></div>
            </div>
            <button class="test-button" onclick="clearLog()" style="margin-top: 10px;">–û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥</button>
        </div>
    </div>

    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ -->
    <div class="notification" id="notification">
        <span id="notificationMessage"></span>
    </div>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        let testStartTime = 0;
        let isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            updateDeviceInfo();
            log('üöÄ –¢–µ—Å—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –¥–ª—è iOS –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω', 'info');
            log(`–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ: ${isIOS ? 'iOS (iPhone/iPad)' : '–î—Ä—É–≥–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ'}`, 'info');
        });
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
        function updateDeviceInfo() {
            const deviceInfo = document.getElementById('deviceInfo');
            const isMobile = /Mobi|Android/i.test(navigator.userAgent);
            const isTablet = /iPad|Android/i.test(navigator.userAgent) && !/Mobile/i.test(navigator.userAgent);
            
            deviceInfo.innerHTML = `
                <p><strong>User Agent:</strong> ${navigator.userAgent}</p>
                <p><strong>–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞:</strong> ${navigator.platform}</p>
                <p><strong>–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ:</strong> ${screen.width}x${screen.height}</p>
                <p><strong>Viewport:</strong> ${window.innerWidth}x${window.innerHeight}</p>
                <p><strong>–¢–∏–ø —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞:</strong> ${isTablet ? '–ü–ª–∞–Ω—à–µ—Ç' : isMobile ? '–ú–æ–±–∏–ª—å–Ω–æ–µ' : '–î–µ—Å–∫—Ç–æ–ø'}</p>
                <p><strong>iOS —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ:</strong> ${isIOS ? '–î–∞' : '–ù–µ—Ç'}</p>
                <p><strong>Touch –ø–æ–¥–¥–µ—Ä–∂–∫–∞:</strong> ${('ontouchstart' in window) ? '–î–∞' : '–ù–µ—Ç'}</p>
            `;
        }
        
        // –°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
        function log(message, type = 'info') {
            const testLog = document.getElementById('testLog');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.className = type;
            logEntry.textContent = `[${timestamp}] ${message}`;
            testLog.appendChild(logEntry);
            testLog.scrollTop = testLog.scrollHeight;
            console.log(`[${type.toUpperCase()}] ${message}`);
        }
        
        // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (–∫–æ–ø–∏—è –∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)
        function showNotification(message, type = "success") {
            const notification = document.getElementById("notification");
            const messageEl = document.getElementById("notificationMessage");

            if (messageEl) {
                messageEl.textContent = message;
            }
            if (notification) {
                notification.className = `notification ${type} show`;
            }

            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –≤—Ä–µ–º—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∏ —Ç–∏–ø–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
            const isTaskCompletion = message.includes('–ó–∞–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ');
            const isDataSaved = message.includes('—Å–æ—Ö—Ä–∞–Ω–µ–Ω') || message.includes('—Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã');
            
            let displayTime = 3000; // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é 3 —Å–µ–∫—É–Ω–¥—ã
            
            if (isIOS) {
                if (isTaskCompletion || isDataSaved) {
                    displayTime = 1000; // 1 —Å–µ–∫—É–Ω–¥–∞ –¥–ª—è iPhone/iPad
                } else {
                    displayTime = 2000; // 2 —Å–µ–∫—É–Ω–¥—ã –¥–ª—è –¥—Ä—É–≥–∏—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
                }
            }

            setTimeout(() => {
                if (notification) {
                    notification.classList.remove("show");
                }
            }, displayTime);
        }
        
        // –§—É–Ω–∫—Ü–∏—è –±—ã—Å—Ç—Ä—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
        function showQuickNotification(message, type = "success") {
            if (isIOS) {
                showNotification(message, type);
            } else {
                showNotification(message, type);
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –º–≥–Ω–æ–≤–µ–Ω–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
        function showInstantNotification(message, type = "success") {
            const notification = document.getElementById("notification");
            const messageEl = document.getElementById("notificationMessage");

            if (messageEl) {
                messageEl.textContent = message;
            }
            if (notification) {
                notification.className = `notification ${type} show`;
            }

            const displayTime = isIOS ? 800 : 3000; // 0.8 —Å–µ–∫—É–Ω–¥—ã –¥–ª—è iOS, 3 –¥–ª—è –¥—Ä—É–≥–∏—Ö

            setTimeout(() => {
                if (notification) {
                    notification.classList.remove("show");
                }
            }, displayTime);
        }
        
        // –¢–µ—Å—Ç–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function testTaskCompletion() {
            testStartTime = Date.now();
            log('üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: "–ó–∞–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ"', 'info');
            showNotification('–ó–∞–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ —Å–µ–≥–æ–¥–Ω—è! +50 XP', 'success');
            log(`–û–∂–∏–¥–∞–µ–º–æ–µ –≤—Ä–µ–º—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è: ${isIOS ? '1 —Å–µ–∫—É–Ω–¥–∞' : '3 —Å–µ–∫—É–Ω–¥—ã'}`, 'info');
        }
        
        function testDataSaved() {
            testStartTime = Date.now();
            log('üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: "–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã"', 'info');
            showNotification('–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ Firebase', 'success');
            log(`–û–∂–∏–¥–∞–µ–º–æ–µ –≤—Ä–µ–º—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è: ${isIOS ? '1 —Å–µ–∫—É–Ω–¥–∞' : '3 —Å–µ–∫—É–Ω–¥—ã'}`, 'info');
        }
        
        function testInstantNotification() {
            testStartTime = Date.now();
            log('üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ', 'info');
            showInstantNotification('–ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ!', 'info');
            log(`–û–∂–∏–¥–∞–µ–º–æ–µ –≤—Ä–µ–º—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è: ${isIOS ? '0.8 —Å–µ–∫—É–Ω–¥—ã' : '3 —Å–µ–∫—É–Ω–¥—ã'}`, 'info');
        }
        
        function testQuickNotification() {
            testStartTime = Date.now();
            log('üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: –ë—ã—Å—Ç—Ä–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ', 'info');
            showQuickNotification('–ë—ã—Å—Ç—Ä–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ!', 'warning');
            log(`–û–∂–∏–¥–∞–µ–º–æ–µ –≤—Ä–µ–º—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è: ${isIOS ? '1 —Å–µ–∫—É–Ω–¥–∞' : '3 —Å–µ–∫—É–Ω–¥—ã'}`, 'info');
        }
        
        function testNormalNotification() {
            testStartTime = Date.now();
            log('üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: –û–±—ã—á–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ', 'info');
            showNotification('–û–±—ã—á–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ', 'info');
            log(`–û–∂–∏–¥–∞–µ–º–æ–µ –≤—Ä–µ–º—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è: ${isIOS ? '2 —Å–µ–∫—É–Ω–¥—ã' : '3 —Å–µ–∫—É–Ω–¥—ã'}`, 'info');
        }
        
        function testMultipleNotifications() {
            log('üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: –ù–µ—Å–∫–æ–ª—å–∫–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø–æ–¥—Ä—è–¥', 'info');
            
            setTimeout(() => {
                showNotification('–ü–µ—Ä–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ', 'success');
                log('–ü–æ–∫–∞–∑–∞–Ω–æ –ø–µ—Ä–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ', 'info');
            }, 100);
            
            setTimeout(() => {
                showNotification('–í—Ç–æ—Ä–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ', 'warning');
                log('–ü–æ–∫–∞–∑–∞–Ω–æ –≤—Ç–æ—Ä–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ', 'info');
            }, 200);
            
            setTimeout(() => {
                showNotification('–¢—Ä–µ—Ç—å–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ', 'error');
                log('–ü–æ–∫–∞–∑–∞–Ω–æ —Ç—Ä–µ—Ç—å–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ', 'info');
            }, 300);
        }
        
        function clearLog() {
            document.getElementById('testLog').innerHTML = '';
            log('üßπ –õ–æ–≥ –æ—á–∏—â–µ–Ω', 'info');
        }
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        setTimeout(() => {
            if (isIOS) {
                log('üçé –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ç–µ—Å—Ç –¥–ª—è iOS —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞', 'info');
                log('–ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã...', 'info');
                
                setTimeout(() => {
                    testTaskCompletion();
                }, 2000);
                
                setTimeout(() => {
                    testDataSaved();
                }, 4000);
                
                setTimeout(() => {
                    testInstantNotification();
                }, 6000);
            }
        }, 1000);
    </script>
</body>
</html>
